#vulnerability scoring data

library(readxl)

ebd_data <- ebirdst_runs %>%
  select(c("species_code","scientific_name","common_name"))

complete <- list.files(path = "D:/floating_solar/generated/")
complete_codes <- str_extract(complete,"[^_]+")

species_selection <- ebd_data %>%
  filter(species_code %in% complete_codes)


#resilience
acad <- read_excel("data/ACAD Global 2024.05.23.xlsx")


acad1 <- acad %>%
  select(c("Common Name","Scientific Name","Group","order","family","CCS-max"))
colnames(acad1) <- c("common_name","scientific_name","group","order","family","CCS-max")

species_selection1 <- left_join(species_selection,acad1, by = "scientific_name")
write.csv(species_selection1,"data/species_data_floating_solar.csv") #fixing a few merging errors manually
species_selection1 <- read.csv("data/species_data_floating_solar.csv")
#all species have CCS-max

#adaptive capacity

axial_length <- read.csv("data/eye_axial_length.csv")
axial_length$scientific_name <- sub("_"," ", axial_length$scientific_name)
length(setdiff(species_selection1$scientific_name,axial_length$scientific_name))

species_selection2 <- left_join(species_selection1,axial_length)

#different dataset
axial_length_2 <- read_excel("data/froelich_2024_axiallength.xlsx")%>%
  select(c("species","EyeAxialLen"))
colnames(axial_length_2) <- c("scientific_name","axial_length_mm")

axial_length_2$scientific_name <- sub("_"," ", axial_length_2$scientific_name)
length(setdiff(species_selection1$scientific_name,axial_length_2$scientific_name))
